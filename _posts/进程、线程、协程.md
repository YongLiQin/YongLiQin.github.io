---
title: 进程、线程、协程
date: 2019-11-02 17:18:39
tags: 操作系统
---

# 序言

在操作系统中研究如何更高效的使用CPU资源至关重要，在许多前辈不断努力的研究探索下，出现了进程、线程、协程等能够实现高效利用CPU资源的思想架构。而如果能够深入理解操作系统中进程、线程、协程的概念对于开发或继续攻克计算机上的难点都能起到非常重要的作用。

## 进程


### 进程引入

现代操作系统的重要特征是多个程序并发运行，能显著提高计算机系统的处理能力和资源利用率。但是由于多个并发程序共享系统资源，因而产生了与程序顺序执行不同的新特性，静态的程序概念已经不能正确描述这些新特性，由此引入了进程的概念。

### 进程的概念

进程映像是指进程实体的组成。进程是一个程序在一个数据集合上的一次运行的过程，因此一个进程必须包含一个或一组可执行的程序，与程序相关的数据集，如程序中定义的全局变量、局部变量、常量等。

要反映进程的动态特性，因此还需要为进程设置一个数据结构，用来描述进程的状态信息、本身的属性、对资源的占用及调度信息等，称为进程控制块，简称PCB，此外，程序在执行中还需要使用栈来跟踪过程调用中的参数传递、存放返回地址、为局部变量分配存储空间等，通常系统会在创建进程时为其建立两个栈：进程在用户态下执行时使用的用户栈以及在系统态下执行时使用的内核栈。综上，进程映像一般应该包括：程序(段)、数据集、栈和PCB，有些系统把栈作为数据集的一部分。

### 进程状态及转换

- 就绪状态: 进程已分配到除处理器外的所有必要资源，只要获得处理器就可以立即执行。
- 运行状态: 处于就绪状态的进程已获得处理器，其程序正在执行。
- 阻塞状态: 正在执行的进程因等待某事件的发生（如请求I/O设备、等待I/O操作完成、等待其他进程发来信号等）而暂停执行的状态，又称为等待状态或睡眠状态。

进程状态转换: 

- 就绪->运行: 处于就绪状态的进程，当进程调度程序为之分配了处理器。
- 运行->就绪: 在分时系统中，当前运行进程如果时间片用完，则暂停运行。
- 运行->阻塞: 当前运行进程因需要等待某事件的发生而无法继续运行，如等待I/O操作的完成，或未能申请到所需的系统资源，或等待其他进程发来信号等，则进程让出CPU，转变为阻塞状态。
- 阻塞->就绪: 处理阻塞状态的进程，所等待的事件已经发生，如I/O操作已完成或获得了所需的资源等，则进程转变为就绪状态等待CPU调度。